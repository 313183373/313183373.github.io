






<!doctype html>
<html lang="">
<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="author" content="Xion">
  
  
  
  
    <meta name="description" content="æˆ‘ä»¬è®²äº†å¾ˆå¤šReduxçš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„ï¼Œæ˜¯åœ¨Reactä¸­ä½¿ç”¨Reduxæ¥ç®¡ç†æˆ‘ä»¬åº”ç”¨çš„çŠ¶æ€ã€‚ä½†è¿˜æ˜¯å¼ºè°ƒä¸€ç‚¹ï¼ŒReactå’ŒReduxæœ¬èº«æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚
æˆ‘ä»¬åœ¨åˆè¯†Reduxä¸­è¯´åˆ°äº†ï¼Œè§£å†³å…±äº«çŠ¶æ€çš„é—®é¢˜çš„æ–¹æ³•å…¶å®è¿˜æ˜¯Contextï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨Reduxæ¥å¯¹Contextä¸­çš„stateçš„ä¿®æ”¹å˜å¾—å¯é¢„æµ‹äº†ã€‚
å¥½çš„ï¼Œæˆ‘ä»¬æ¥ç†ä¸€ä¸‹æ€è·¯ï¼š

é¦–å…ˆç”¨Contextä¿å­˜æˆ‘ä»¬æˆ‘ä»¬åˆ›å»ºçš„store
åœ¨éœ€...">
  
  <title>Reduxä¸Reactç»“åˆ [ ç†Šé‘«çš„ç¾å¥½ç”Ÿæ´» ]</title>
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
  <link rel="stylesheet" href="/css/random.css">
<link rel="stylesheet" href="/css/vegas.min.css">
<link rel="stylesheet" href="/css/highlight-railscasts.css">
<link rel="stylesheet" href="/css/jquery.fancybox.css">
<link rel="stylesheet" href="/css/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/jquery.fancybox-thumbs.css">
<link rel="stylesheet" href="/css/plyr.css">
  
</head>

<body>
<div class="side-navigate hide-area">
  
  
    <div class="item next">
      <a href="/2018/08/17/Reduxä¸­é—´ä»¶å’Œå¼‚æ­¥æ“ä½œ/">
        <div class="item-icon"></div>
      </a>
      <div class="item-title">
        Reduxä¸­é—´ä»¶å’Œå¼‚æ­¥æ“ä½œ
      </div>
    </div>
  
</div>
<div id="outer-container" class="hide-area">
<div id="container">
  <div id="menu-outer" class="slide-down">
    <div id="menu-inner">
      <div id="brand">
        
        <a onClick="openUserCard()">
          <img id="avatar" src="https://ws1.sinaimg.cn/large/006tKfTcgy1ft9vmze9s2j30k00hfdh3.jpg"/>
          <div id="homelink">ç†Šé‘«çš„ç¾å¥½ç”Ÿæ´»</div>
        </a>
      </div>
      <div id="menu-list">
        <ul>
        
        
          
            <li>
          
            <a href="/">é¦–é¡µ</a>
            
          </li>
        
          
            <li>
          
            <a href="/archives">æ–‡ç« </a>
            
          </li>
        
          
            <li>
          
            <a href="/tags">æ ‡ç­¾</a>
            
          </li>
        
          
            <li>
          
            <a href="/categories">åˆ†ç±»</a>
            
          </li>
        
          
            <li>
          
            <a href="https://github.com/313183373">Github</a>
            
          </li>
        
        </ul>
      </div>
      <div id="show-menu">
        <button>Menu</button>
      </div>
    </div>
  </div>

  <div id="content-outer">
    <div id="content-inner">
      <div id="Jihuajiyi" style="display:none"></div>
      
      
  <article id="post">
    <h1>Reduxä¸Reactç»“åˆ</h1>
    <p class="page-title-sub">
      <span id = "post-title-date">æ’°å†™äº 2018-08-22</span>
      
        <span id = "post-title-updated">ä¿®æ”¹äº 2018-08-24</span>
      
      
      
      <span id = "post-title-tags">
      æ ‡ç­¾
      
      
        
        
        <a href="/tags/Redux/">Redux</a>
      
        
          /
        
        
        <a href="/tags/React/">React</a>
      
      </span>
      
    </p>
    
    <p>æˆ‘ä»¬è®²äº†å¾ˆå¤šReduxçš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„ï¼Œæ˜¯åœ¨Reactä¸­ä½¿ç”¨Reduxæ¥ç®¡ç†æˆ‘ä»¬åº”ç”¨çš„çŠ¶æ€ã€‚ä½†è¿˜æ˜¯å¼ºè°ƒä¸€ç‚¹ï¼ŒReactå’ŒReduxæœ¬èº«æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚</p>
<p>æˆ‘ä»¬åœ¨<a href="http://xxxxion.com/2018/08/14/åˆè¯†Redux/">åˆè¯†Redux</a>ä¸­è¯´åˆ°äº†ï¼Œè§£å†³å…±äº«çŠ¶æ€çš„é—®é¢˜çš„æ–¹æ³•å…¶å®è¿˜æ˜¯<code>Context</code>ï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨Reduxæ¥å¯¹<code>Context</code>ä¸­çš„<code>state</code>çš„ä¿®æ”¹å˜å¾—å¯é¢„æµ‹äº†ã€‚</p>
<p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥ç†ä¸€ä¸‹æ€è·¯ï¼š</p>
<ol>
<li>é¦–å…ˆç”¨<code>Context</code>ä¿å­˜æˆ‘ä»¬æˆ‘ä»¬åˆ›å»ºçš„<code>store</code></li>
<li>åœ¨éœ€è¦è·å–<code>state</code>çš„ç»„ä»¶ä¸­è·å–<code>store</code>ï¼Œç„¶åç”¨<code>getState</code>æ¥è·å–<code>state</code></li>
<li>åœ¨éœ€è¦ä¿®æ”¹<code>state</code>çš„ç»„ä»¶ä¸­è·å–<code>store</code>ï¼Œç„¶åç”¨<code>dispatch</code>ä¸€ä¸ª<code>action</code>æ¥ä¿®æ”¹<code>state</code></li>
<li>å¿˜äº†ä»€ä¹ˆï¼Ÿæƒ³æƒ³stateçš„æ”¹å˜ä¹‹åï¼Œç”¨åˆ°è¿™äº›stateçš„ç»„ä»¶æœ‰æ›´æ–°å—ï¼Ÿæ²¡æœ‰ï¼æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ³¨å†Œç›‘å¬å™¨ã€‚</li>
</ol>
<p>å¥½äº†ï¼Œæ€è·¯å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬æ¥è¯•è¯•å†™ä¸€ä¸ªå°åº”ç”¨æ¥è¯•è¯•Reduxå’ŒReactç»“åˆå§ï¼</p>
<p>æˆ‘ä»¬å†™ä¸€ä¸ªTodoListçš„åº”ç”¨ï¼ŒæŠŠæ‰€æœ‰çš„todoéƒ½ç”¨Reduxæ¥ç®¡ç†ï¼Œtodoçš„ç»“æ„æ˜¯è¿™æ ·çš„</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">todo: [</span><br><span class="line">    &#123;</span><br><span class="line">        text: String, 		//todoçš„å†…å®¹</span><br><span class="line">        completed: Bool		//æ˜¯å¦å·²ç»å®Œæˆ</span><br><span class="line">        id: Number</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¾—é€‰æ‹©æŸ¥çœ‹æ‰€æœ‰çš„todoï¼Œæˆ–è€…å·²å®Œæˆçš„todoï¼Œæˆ–è€…æœªå®Œæˆçš„todoã€‚</p>
<p>æ‰€ä»¥è¿˜å¾—æœ‰ä¸€ä¸ªä¿å­˜æˆ‘ä»¬æƒ³æŸ¥çœ‹ä»€ä¹ˆçš„å±æ€§visibleã€‚</p>
<p>å¥½çš„ï¼Œé‚£æˆ‘ä»¬ç®€å•çš„ä¼°è®¡ä¸€ä¸‹æˆ‘ä»¬çš„åº”ç”¨åº”è¯¥é•¿è¿™ä¸ªæ ·å­ï¼š</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fuibmifelij30oa0mi75p.jpg" alt="image-20180822112805864"></p>
<p>ç„¶ååˆ†æä¸€ä¸‹æˆ‘ä»¬çš„ç»„ä»¶å¦‚ä½•åˆ’åˆ†ï¼Ÿ</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fuig79jsrnj30uq0qadid.jpg" alt="image-20180822141118712"></p>
<p>å¥½äº†ï¼Œä»å¤§åˆ°å°ï¼Œä»ç®€å•åˆ°å¤æ‚çš„å†™ä¸€ä¸‹æŠŠï¼Œå…ˆå†™<code>TodoListApp</code>ç»„ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ<code>Context</code>åœ¨è¿™é‡Œåˆ›å»ºå‡ºæ¥ï¼š</p>
<blockquote>
<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¼ ç»Ÿçš„Contextå†™æ³•ï¼Œå®˜ç½‘ç›®å‰æœ‰Contextæ–°çš„ç”¨æ³•ï¼Œä¼ ç»Ÿå†™æ³•åœ¨æœªæ¥å¯èƒ½ä¸è¢«æ”¯æŒï¼Œç°åœ¨æˆ‘ä»¬å…ˆè¿™ä¹ˆä½¿ç”¨ï¼Œå…¶å®React-Reduxåº“ä¸­ä¹Ÿæ˜¯ä½¿ç”¨çš„è¿™ç§Contextçš„å†™æ³•ã€‚</p>
</blockquote>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducers'</span>;</span><br><span class="line"><span class="comment">// çœç•¥ä¸€äº›import</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoListApp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> childContextTypes = &#123;</span><br><span class="line">        store: PropTypes.object.isRequired,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    getChildContext = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;store&#125;;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;AddTodo/&gt;</span><br><span class="line">                &lt;TodoList/&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœç•¥æ‰reducerçš„å†™æ³•ï¼Œè¿™ä¸æ˜¯ç°åœ¨çš„é‡ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¿™é‡Œä½¿ç”¨<code>Context</code>æ¥ä¿å­˜<code>store</code>ï¼Œæ‰€æœ‰çš„åä»£éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ª<code>store</code>äº†ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å†™<code>TodoList</code>ç»„ä»¶ï¼Œæˆ‘ä»¬éœ€è¦è·å–åˆ°<code>TodoListApp</code>çš„<code>Context</code>ï¼Œç„¶åè·å–åˆ°<code>store</code>ï¼Œç„¶åè·å–åˆ°æ‰€æœ‰çš„<code>todo</code>ï¼Œæœ€åå±•ç¤ºå‡ºæ¥ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> contextTypes = &#123;</span><br><span class="line">        store: PropTypes.object.isRequired,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        <span class="keyword">const</span> &#123;<span class="attr">todo</span>: todos, visible&#125; = store.getState();</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">                &#123;todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span></span><br><span class="line">                    visible === <span class="string">'ALL'</span> ? <span class="literal">true</span> : visible === <span class="string">'COMPLETED'</span> ? todo.completed : !todo.completed)</span><br><span class="line">                    .map(<span class="function"><span class="params">todo</span> =&gt;</span> &lt;Todo &#123;...todo&#125; key=&#123;todo.id&#125;/&gt;)&#125;</span><br><span class="line">            &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†æ›´å¥½çš„æµ‹è¯•æˆ‘ä»¬çš„ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦åœ¨stateåˆå§‹åŒ–çš„æ—¶å€™ï¼Œç»™å®ƒäººå·¥è®¾ç½®ä¸€äº›åˆå§‹å€¼ï¼Œæˆ‘è¿™é‡Œç»™çš„å°±æ˜¯</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;text: 'learn react', completed: true, id: 1&#125;, &#123;text: 'learn redux', completed: false, id: 2&#125;]</span><br></pre></td></tr></table></figure>
<p>ä¸¤ä¸ªtodoé¡¹ï¼Œä¸€ä¸ªå·²å®Œæˆï¼Œä¸€ä¸ªæœªå®Œæˆï¼Œç„¶åï¼Œæˆ‘ä»¬ç»§ç»­çœ‹çœ‹Todoç»„ä»¶ï¼Œå®ƒå°±æ˜¯ç®€å•çš„æ ¹æ®æ˜¯å¦å®Œæˆæ¥å±•ç¤ºä¸åŒçš„æ•ˆæœï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;text, completed&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> style = &#123;<span class="attr">textDecoration</span>: completed ? <span class="string">'line-through'</span> : <span class="string">'none'</span>&#125;;</span><br><span class="line">        <span class="keyword">return</span> &lt;li style=&#123;style&#125;&gt;&#123;text&#125;&lt;/li&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬çœ‹çœ‹æ•ˆæœå§</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fujo9mtm1bj307y02y74a.jpg" alt="image-20180823153554850"></p>
<p>æŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„æ–¹å¼æ˜¾ç¤ºäº†ï¼Œè¿˜ä¸é”™ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»™æ¯ä¸ªtodoé¡¹æ·»åŠ ä¸€ä¸ªé¼ æ ‡äº‹ä»¶ï¼Œå½“é¼ æ ‡ç‚¹å‡»å®ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ”¹å˜è¿™ä¸ªtodoé¡¹çš„å®ŒæˆçŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„Todoç»„ä»¶ï¼Œè®©å®ƒå¯ä»¥ä½¿ç”¨<code>dispatch</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å…ˆç”¨<code>prop-types</code>æ¥å£°æ˜ä¸€ä¸‹<code>Context</code>çš„ç±»å‹ï¼Œç„¶ååœ¨ç‚¹å‡»çš„æ—¶å€™<code>dispatch</code>ä¸€ä¸ª<code>action</code>ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Todo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> contextTypes = &#123;</span><br><span class="line">        store: PropTypes.object.isRequired,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;id&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        store.dispatch(&#123;</span><br><span class="line">            type:<span class="string">'TOGGLE_TODO'</span>,</span><br><span class="line">            id,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;text, completed&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> style = &#123;<span class="attr">textDecoration</span>: completed ? <span class="string">'line-through'</span> : <span class="string">'none'</span>&#125;;</span><br><span class="line">        <span class="keyword">return</span> &lt;li style=&#123;style&#125; onClick=&#123;this.handleClick&#125;&gt;&#123;text&#125;&lt;/li&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†è¿™ä¸ªåŠŸèƒ½ï¼Œç°åœ¨è®©æˆ‘ä»¬è¯•ä¸€è¯•ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ•ˆæœã€‚</p>
<p>å¥½åƒæ²¡æœ‰ä»€ä¹ˆæ•ˆæœå‘€ï¼Œæ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜å‘€ï¼Œæˆ‘ä»¬ç”¨ä¹‹å‰æˆ‘ä»¬å†™è¿‡çš„Reduxä¸­é—´ä»¶<code>logger</code>æ¥çœ‹çœ‹çŠ¶æ€æ˜¯ä¸æ˜¯çœŸçš„æ”¹å˜äº†ï¼Œæˆ‘ä»¬åœ¨åˆ›å»º<code>store</code>çš„æ—¶å€™ä¼ å…¥ä¸€ä¸ªä¸­é—´ä»¶æŠŠã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> logger = <span class="function"><span class="params">store</span> =&gt;</span> next =&gt; <span class="function"><span class="params">action</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'dispatch :'</span>, action.type);</span><br><span class="line">    next(action);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'new state :'</span>, store.getState());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer, applyMiddleware(logger));</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªtodoé¡¹ï¼Œçœ‹æ§åˆ¶å°ã€‚</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fujoqqhwh2j31dg02ymxw.jpg" alt="image-20180823155223504"></p>
<p>æœ‰çš„åŒå­¦å¯èƒ½ä¼šè¯´ï¼Œè¿™ä¸ªloggerè¿™ä¸ªä¸­é—´ä»¶åº”è¯¥æ˜¯å¾ˆå¸¸ç”¨çš„æŠŠï¼Œè‚¯å®šæœ‰äººå†™äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„ä¸­é—´ä»¶ã€‚</p>
<p>ç¡®å®æ˜¯æœ‰å“¦ï¼Œè¿™ä¸ªä¸­é—´ä»¶å°±å«redux-loggerï¼Œæˆ‘ä»¬å¯ä»¥ç”¨npmä¸‹è½½ä¸‹æ¥ï¼Œç„¶åä½¿ç”¨ä¸€ä¸‹ï¼Œä»¥åæˆ‘ä»¬ä¹Ÿéƒ½ä½¿ç”¨åˆ«äººå†™å¥½çš„ä¸­é—´ä»¶ã€‚æˆ‘ä»¬åªç”¨çŸ¥é“ä¸­é—´ä»¶åº”è¯¥æ€ä¹ˆå†™ï¼Œä»¥åŠä¸­é—´ä»¶çš„åŸç†å°±å¥½äº†ã€‚</p>
<p>æˆ‘ä»¬ç°åœ¨æ”¹ç”¨redux-loggerä¸­é—´ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'redux-logger'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer, applyMiddleware(logger));</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å†æ¬¡ç‚¹å‡»ï¼Œç„¶åæŸ¥çœ‹æ§åˆ¶å°</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fujov2xxulj31eq058myy.jpg" alt="image-20180823155633904"></p>
<p>ç¡®å®å¥½çœ‹äº†å¾ˆå¤šğŸ¤£</p>
<p>å¥½çš„ï¼Œåˆ«å¿˜äº†æˆ‘ä»¬çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬æ˜¯ä¸ºäº†çœ‹æˆ‘ä»¬ç‚¹å‡»ä¹‹åï¼Œ<code>state</code>æ˜¯å¦æ”¹å˜ï¼Œç°åœ¨çœ‹æ¥æ˜¯æ”¹å˜äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆç»„ä»¶æ²¡æœ‰å˜åŒ–å‘¢ï¼Ÿ</p>
<p>é‚£æ˜¯å› ä¸ºæˆ‘ä»¬<code>state</code>çš„å˜åŒ–æ²¡æœ‰è®¾ç½®ç›‘å¬å™¨ï¼Œç»„ä»¶å…¶å®å¹¶ä¸çŸ¥é“åŸæ¥<code>store</code>ä¸­çš„<code>state</code>å˜åŒ–äº†ï¼Œæ‰€ä»¥å°±æ²¡æœ‰æ”¹å˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥è®¾ç½®ä¸€ä¸‹ç›‘å¬å™¨ï¼Œæˆ‘ä»¬æŠŠ<code>store</code>ä¸­çš„<code>state</code>ä¹Ÿå˜æˆ<code>TodoList</code>è¿™ä¸ªç»„ä»¶çš„<code>state</code>ï¼Œç„¶åç›‘å¬å™¨å°±æ˜¯å½“<code>store</code>ä¸­çš„<code>state</code>å˜åŒ–çš„æ—¶å€™ï¼Œè°ƒç”¨<code>setState</code>æ”¹å˜ç»„ä»¶çš„<code>state</code>ï¼Œè®©å®ƒè‡ªå·±å»æ›´æ–°ç»„ä»¶ï¼Œæ€è·¯å°±æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼€å§‹ä¿®æ”¹ä»£ç ã€‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TodoList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–state</span></span><br><span class="line">    state = &#123;</span><br><span class="line">        todos:[],</span><br><span class="line">        visible: <span class="string">''</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> contextTypes = &#123;</span><br><span class="line">        store: PropTypes.object.isRequired,</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="comment">// åœ¨ç»„ä»¶æŒ‚è½½åï¼Œä½¿ç”¨å†…éƒ¨æ–¹æ³•updateTodoListæ¥æ›´æ–°state</span></span><br><span class="line">	<span class="comment">// åŒæ—¶è®¾ç½®ç›‘å¬å™¨</span></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        <span class="keyword">this</span>._updateTodoList();</span><br><span class="line">        store.subscribe(<span class="keyword">this</span>._updateTodoList);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// è·å–æœ€æ–°çš„stateç„¶åæ›´æ–°</span></span><br><span class="line">    _updateTodoList = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        <span class="keyword">const</span> state = store.getState();</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            todos: state.todo,</span><br><span class="line">            visible: state.visible,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;todos, visible&#125; = <span class="keyword">this</span>.state;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">                &#123;todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span></span><br><span class="line">                    visible === <span class="string">'ALL'</span> ? <span class="literal">true</span> : visible === <span class="string">'COMPLETED'</span> ? todo.completed : !todo.completed)</span><br><span class="line">                    .map(<span class="function"><span class="params">todo</span> =&gt;</span> &lt;Todo &#123;...todo&#125; key=&#123;todo.id&#125;/&gt;)&#125;</span><br><span class="line">            &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œç»è¿‡æˆ‘ä»¬è¿™ä¸ªä¸€æŠ˜è…¾ï¼Œå†æ¥è¯•è¯•</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fujpmn8qklg304h02djrc.gif" alt="1"></p>
<p>æœ‰ååº”äº†ï¼Œä¸é”™ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦æ·»åŠ ä¸‰ä¸ªæ ‡ç­¾ï¼Œæ˜¾ç¤ºå½“å‰æŸ¥çœ‹çš„æ˜¯æ‰€æœ‰çš„todoè¿˜æ˜¯å·²å®Œæˆçš„todoï¼Œè¿˜æ˜¯æœªå®Œæˆçš„ã€‚</p>
<p>æˆ‘ä»¬å•ç‹¬å†™ä¸€ä¸ª<code>VisibleLink</code>ç»„ä»¶ï¼Œå› ä¸ºå½“<code>visible</code>æ˜¯<code>all</code>çš„æ—¶å€™ï¼Œæ˜¾ç¤ºALLçš„<code>VisibleLink</code>éœ€è¦ç‰¹åˆ«æ˜¾ç¤ºï¼ˆæ˜¾ç¤ºä¸ºçº¢è‰²ï¼‰ã€‚</p>
<p>è¯·å¤§å®¶å…ˆèŠ±äº›æ—¶é—´è‡ªå·±å»å†™è¿™ä¸ªç»„ä»¶</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VisibleLink</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ç”¨prop-typesåº“æ¥æ£€æµ‹Contextçš„ç±»å‹</span></span><br><span class="line">    <span class="comment">// è¿™ä¹Ÿæ˜¯ä½¿ç”¨Contextå¿…é¡»çš„</span></span><br><span class="line">    <span class="keyword">static</span> contextTypes = &#123;</span><br><span class="line">        store: PropTypes.object.isRequired,</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="comment">// ç‚¹å‡»çš„è¯ä¼šdispatchä¸€ä¸ªaction</span></span><br><span class="line">	<span class="comment">// è¿™é‡Œä¸éœ€è¦ç›‘å¬å™¨ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</span></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        store.dispatch(&#123;</span><br><span class="line">            type: <span class="string">'SET_VISIBLE'</span>,</span><br><span class="line">            visible: <span class="keyword">this</span>.props.visible,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="comment">// æ ¹æ®ä¼ è¿›æ¥çš„visibleå‚æ•°å’Œcontextæ¥åˆ¤å®šæ˜¯å¦åº”è¯¥æ˜¾ç¤ºçº¢è‰²</span></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;visible&#125; = <span class="keyword">this</span>.props;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        <span class="keyword">const</span> style = &#123;</span><br><span class="line">            color: store.getState().visible === visible ? <span class="string">'red'</span> : <span class="string">'black'</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> &lt;span onClick=&#123;this.handleClick&#125; style=&#123;style&#125;&gt;&#123;visible&#125;&lt;/span&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆä¸éœ€è¦ç›‘å¬å™¨å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬çš„<code>visible</code>å‚æ•°æ˜¯ä»çˆ¶ç»„ä»¶ä¼ é€’è¿›æ¥çš„ï¼Œåªè¦æˆ‘ä»¬çš„çˆ¶ç»„ä»¶æœ‰ç›‘å¬å™¨å¹¶ä¸”ä¼šæ›´æ–°çš„è¯ï¼Œå­ç»„ä»¶è‡ªç„¶ä¼šå› ä¸ºæ¥æ”¶åˆ°äº†ä¸åŒçš„propsè€Œæ›´æ–°ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æŠŠ<code>VisibleLink</code>ç»„ä»¶ç”¨äº<code>TodoList</code>ç»„ä»¶ä¸­</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TodoListç»„ä»¶çš„renderæ–¹æ³•</span></span><br><span class="line">render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;todos, visible&#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;VisibleLink visible=<span class="string">'ALL'</span>/&gt;&amp;nbsp;</span><br><span class="line">            &lt;VisibleLink visible=<span class="string">'COMPLETED'</span>/&gt;&amp;nbsp;</span><br><span class="line">            &lt;VisibleLink visible=<span class="string">'UNCOMPLETED'</span>/&gt;</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">                &#123;todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span></span><br><span class="line">                    visible === <span class="string">'ALL'</span> ? <span class="literal">true</span> : visible === <span class="string">'COMPLETED'</span> ? todo.completed : !todo.completed)</span><br><span class="line">                    .map(<span class="function"><span class="params">todo</span> =&gt;</span> &lt;Todo &#123;...todo&#125; key=&#123;todo.id&#125;/&gt;)&#125;</span><br><span class="line">            &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬è¯•è¯•æ•ˆæœ</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fujs0coiebg308g02dta9.gif" alt="1"></p>
<p>æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœäº†ï¼Œç°åœ¨æˆ‘ä»¬è¿˜å·®ä¸€ä¸ªæ·»åŠ <code>todo</code>çš„<code>AddTodo</code>ç»„ä»¶æ²¡æœ‰å†™äº†</p>
<p>è¿™ä¸ªç»„ä»¶å¤§å®¶è‡ªå·±å†™å§ï¼Œæˆ‘åœ¨ä¸‹é¢ç»™å‡ºä¸€ä¸ªå†™æ³•</p>
<hr>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddTodo</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        text: <span class="string">''</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> contextTypes = &#123;</span><br><span class="line">        store: PropTypes.object.isRequired</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    handleChange = <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            text: event.target.value,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;store&#125; = <span class="keyword">this</span>.context;</span><br><span class="line">        store.dispatch(&#123;</span><br><span class="line">            type: <span class="string">'ADD_TODO'</span>,</span><br><span class="line">            text: <span class="keyword">this</span>.state.text,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            text: <span class="string">''</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;input type=<span class="string">"text"</span> value=&#123;<span class="keyword">this</span>.state.text&#125; onChange=&#123;<span class="keyword">this</span>.handleChange&#125;/&gt;</span><br><span class="line">                &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;æäº¤&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»ç”¨Reduxé…åˆReactå®Œæˆäº†ä¸€ä¸ªç®€æ˜“TodoListçš„ç½‘é¡µåº”ç”¨äº†ï¼Œå¤§å®¶çš„æ„Ÿè§‰æ€ä¹ˆæ ·ï¼Ÿ</p>
<p>æˆ‘è¿™ä¸€è·¯å†™ä¸‹æ¥æ„Ÿè§‰æœ‰å¾ˆå¤šçš„é‡å¤ä»£ç ï¼Œæ¯”å¦‚è·å–Contextï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œç”¨åˆ°Contextçš„ç»„ä»¶å…¨éƒ¨éƒ½ä¸èƒ½å¤ç”¨ï¼Œå› ä¸ºè¿™ä¸ªç»„ä»¶åŒ…å«äº†å¾ˆå¤šé€»è¾‘ï¼Œç„¶è€Œä¸åŒåœ°æ–¹çš„é€»è¾‘ä¸ä¸€å®šç›¸åŒã€‚</p>
<p>é’ˆå¯¹ç›®å‰çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¾—æƒ³åŠæ³•ä¼˜åŒ–ä¸€ä¸‹ï¼Œæ€è·¯å°±æ˜¯ï¼Œæˆ‘ä»¬å¾—æŠŠé€»è¾‘å’Œæ˜¾ç¤ºåˆ†ç¦»ï¼Œç›®å‰æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­æ··åˆäº†é€»è¾‘å’Œæ˜¾ç¤ºï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿè¿˜è®°å¾—æˆ‘ä»¬çš„é«˜é˜¶ç»„ä»¶å—ï¼Ÿ</p>
<p>ä¸‹ä¸€å°èŠ‚ï¼Œæˆ‘ä»¬æ¥ä¼˜åŒ–è¿™ä¸ªTodoListåº”ç”¨ï¼</p>

  </article>
  <div class="random-toc-area">
  <button class="btn-hide-toc btn-hide-toc-show" style="display: none" onclick="TOCToggle()">æ˜¾ç¤ºç›®å½•</button>
  <button class="btn-hide-toc btn-hide-toc-hide" onclick="TOCToggle()">éšè—ç›®å½•</button>
  <div class="random-toc">
    <h2>ç›®å½•</h2>
    
  </div>
</div>

  
<nav id="pagination">
  

  

  
    <a href="/2018/08/17/Reduxä¸­é—´ä»¶å’Œå¼‚æ­¥æ“ä½œ/" class="next">ä¸‹ä¸€ç¯‡ Reduxä¸­é—´ä»¶å’Œå¼‚æ­¥æ“ä½œ &rarr;</a>
  
</nav>

  <!-- JiaThis Button BEGIN -->

<!-- JiaThis Button END -->


      
      
      
      <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
<div id="lv-container" data-id="city" data-uid="MTAyMC8zODM1Ny8xNDg4NQ==">
	<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
<noscript> ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
</div>
<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
      
      <script src="http://open.iciba.com/huaci/huaci.js" ></script>
    </div>
  </div>
</div>

</div>


<div id="user-card">
  <div class="center-field">
    <img class="avatar" src="https://ws1.sinaimg.cn/large/006tKfTcgy1ft9vmze9s2j30k00hfdh3.jpg">
    <p id="description"></p>
    <ul class="social-icon">
  
  
</ul>
  </div>
</div>


<div id="btn-view">Hide</div>

<script>
// is trigger analytics / tongji script
var isIgnoreHost = false;

if(window && window.location && window.location.host) {
  isIgnoreHost = ["localhost","127.0.0.1"].some(function(address){
    return 0 === window.location.host.indexOf(address);
  });
}

var isTriggerAnalytics = !( true && isIgnoreHost );

</script>




  
  
    <script src="/js/jquery-2.2.3.min.js"></script>
  
    <script src="/js/vegas.min.js"></script>
  
    <script src="/js/random.js"></script>
  
    <script src="/js/highlight.pack.js"></script>
  
    <script src="/js/jquery.mousewheel.pack.js"></script>
  
    <script src="/js/jquery.fancybox.pack.js"></script>
  
    <script src="/js/jquery.fancybox-thumbs.js"></script>
  
    <script src="/js/plyr.js"></script>
  

<script>

  // fancybox
  var backgroundImages = [];
  
  $('#post').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox') || $(this).parent().hasClass('fancybox-thumb')) return;
      var alt = this.alt || this.title;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'post' + i);
    });
  });
  $(".fancybox").fancybox();

var vegasConfig = {"animation":"random","preloadÂ­Image":true,"transition":["slideLeft2","slideRight2","zoomIn","swirLeft","swirRight","flash","flash2"],"timer":true,"delay":5000,"shuffle":true,"count":10};
var unsplashConfig = {"gravity":"north"};
// is show background images
var turnoffBackgroundImage = false;



  turnoffBackgroundImage = true;


var backgroundColor = "34495E";

$(".fancybox-thumb").fancybox({
  prevEffect: 'none',
  nextEffect: 'none',
  helpers: {
    title: {
      type: 'outside'
    },
    thumbs: {
      width: 50,
      height: 50
    }
  }
});

// show video with plyr
$(".video-container iframe").each(function(i){
  var url = $(this).attr('src');
  var id = url.split('/').pop();
  var plyrContainer = document.createElement('div');
  plyrContainer.className = 'plyr';
  var plyrElement = document.createElement('div');
  plyrElement.dataset.videoId = id;
  switch(true) {
    case url.search('youtube.com') >= 0:
      plyrElement.dataset.type = 'youtube';
      break;
    case url.search('vimeo.com') >= 0:
      plyrElement.dataset.type = 'vimeo';
      break;
    default:
      return;
  };
  plyrContainer.appendChild(plyrElement);
  $(this).parent().html(plyrContainer);
});
plyr.setup('.plyr', {iconUrl: '/css/sprite.svg'});
</script>
</body>
</html>

